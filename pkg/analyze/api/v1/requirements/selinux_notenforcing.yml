raw:
  conditions:
    - eval:
        operator: and
        statements:
          - '{{repl .Empty}}'
        variables:
          - Empty: '{{repl not ._Ref}}'
      severity: error
      message: >-
        Failed to detect SELinux mode
    - eval:
        operator: and
        statements:
          - '{{repl eq .Status "enabled"}}'
          - '{{repl eq .Mode "enforcing"}}'
        variables:
          - Status: '{{repl regexSplit ":\\s+" (regexFind "(?m)^SELinux status:.+$" ._Ref) 2 | last}}'
          - Mode: '{{repl regexSplit ":\\s+" (regexFind "(?m)^Current mode:.+$" ._Ref) 2 | last}}'
      severity: error
      message: >-
        SELinux is in enforcing mode. This mode is currently unsupported. Please either disable SELinux or change the mode to permissive.
message: SELinux must not be in enforcing mode
